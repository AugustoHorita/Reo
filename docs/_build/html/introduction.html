

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; Reo 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Reo 1.0 documentation" href="index.html"/>
        <link rel="next" title="Tutorial" href="tutorial.html"/>
        <link rel="prev" title="Installation" href="installation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Reo
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#a-simple-concurrent-program">A simple concurrent program</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysis">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reo-protocols">Reo protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compilation">Compilation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#components-and-interfaces">Components and interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#reference-to-java-source-code">1. Reference to Java source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#definition-of-formal-semantics">2. Definition of formal semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#definition-as-composition">3. Definition as composition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#predicates">Predicates</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#terms">Terms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#sections-and-imports">Sections and Imports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="library.html">Library of components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="library.html#atomic-components">1. Atomic components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="library.html#sync">Sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#fifo1">Fifo1</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#syncdrain">Syncdrain</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#lossysync">Lossysync</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#filter">Filter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="library.html#connector-components">2. Connector components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="library.html#regulatorwwr">Regulatorwwr</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#barrier">Barrier</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#alternator">Alternator</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#circulator">Circulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#ovflfifo">Ovflfifo</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#regulatorwrr">Regulatorwrr</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#seqp">Seqp</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#seqc">Seqc</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#shiftlossyfifo">Shiftlossyfifo</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#variable">Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#xrouter">Xrouter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="library.html#boundary-components">3. Boundary components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="library.html#java">3.1 Java</a></li>
<li class="toctree-l3"><a class="reference internal" href="library.html#promela">3.2 Promela</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#clone-the-repository">Clone the repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#build-the-project">Build the project</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#documentation-by-javadoc">Documentation by Javadoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#setting-up-eclipse">Setting up Eclipse</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#adding-new-semantics-to-the-compiler">Adding new semantics to the compiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#future-work">Future work</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#references">References</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Reo</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/introduction.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="a-simple-concurrent-program">
<h2>A simple concurrent program<a class="headerlink" href="#a-simple-concurrent-program" title="Permalink to this headline">¶</a></h2>
<p>Writing correct concurrent programs is far more difficult than writing correct sequential programs.
Let us start with very simple program that repeatedly prints &#8220;Hello, &#8221; and &#8220;world!&#8221; in alternating order.
We split this program into three different processes: two producers that output a string &#8220;Hello, &#8221; and &#8220;world!&#8221;, respectively,
and a consumer that <strong>alternately</strong> prints the produced strings &#8220;Hello, &#8221; and &#8220;world!&#8221;, starting of course with &#8220;Hello, &#8221;.</p>
<p>If you are asked to write a small program that implements the above informal specification, you may come up with the following Java code:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">java.util.concurrent.Semaphore</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Semaphore</span> <span class="n">greenSemaphore</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Semaphore</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Semaphore</span> <span class="n">redSemaphore</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Semaphore</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Semaphore</span> <span class="n">bufferSemaphore</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Semaphore</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">buffer</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Thread</span> <span class="n">redProducer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="s">&quot;Red Producer&quot;</span><span class="o">)</span> <span class="o">{</span>
                        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                                        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">30000000</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">);</span>
                                        <span class="n">String</span> <span class="n">redText</span> <span class="o">=</span> <span class="s">&quot;Hello, &quot;</span><span class="o">;</span>
                                        <span class="k">try</span> <span class="o">{</span>
                                                <span class="n">redSemaphore</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>
                                                <span class="n">bufferSemaphore</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>
                                                <span class="n">buffer</span> <span class="o">=</span> <span class="n">redText</span><span class="o">;</span>
                                                <span class="n">bufferSemaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
                                                <span class="n">greenSemaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
                                        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
                                <span class="o">}</span>
                        <span class="o">}</span>
                <span class="o">};</span>

                <span class="n">Thread</span> <span class="n">greenProducer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="s">&quot;Green Producer&quot;</span><span class="o">)</span> <span class="o">{</span>
                        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                                        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50000000</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">);</span>
                                        <span class="n">String</span> <span class="n">redText</span> <span class="o">=</span> <span class="s">&quot;world! &quot;</span><span class="o">;</span>
                                        <span class="k">try</span> <span class="o">{</span>
                                                <span class="n">greenSemaphore</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>
                                                <span class="n">bufferSemaphore</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>
                                                <span class="n">buffer</span> <span class="o">=</span> <span class="n">redText</span><span class="o">;</span>
                                                <span class="n">bufferSemaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
                                                <span class="n">redSemaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
                                        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                                                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                                        <span class="o">}</span>
                                <span class="o">}</span>
                        <span class="o">}</span>
                <span class="o">};</span>

                <span class="n">Thread</span> <span class="n">blueConsumer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="s">&quot;Blue Consumer&quot;</span><span class="o">)</span> <span class="o">{</span>
                        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                                <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                                <span class="k">while</span> <span class="o">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">)</span> <span class="o">{</span>
                                        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">40000000</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">);</span>
                                        <span class="k">try</span> <span class="o">{</span>
                                                <span class="n">bufferSemaphore</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>
                                                <span class="k">if</span> <span class="o">(</span><span class="n">buffer</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">buffer</span><span class="o">);</span>
                                                        <span class="n">buffer</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                                                        <span class="n">k</span><span class="o">++;</span>
                                                <span class="o">}</span>
                                                <span class="n">bufferSemaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
                                        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                                                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                                        <span class="o">}</span>
                                <span class="o">}</span>
                        <span class="o">}</span>
                <span class="o">};</span>

                <span class="n">redProducer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
                <span class="n">greenProducer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
                <span class="n">blueConsumer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

                <span class="k">try</span> <span class="o">{</span>
                        <span class="n">blueConsumer</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The main method in the above Java code instantiates three different Java <a class="reference external" href="https://docs.oracle.com/javase/tutorial/essential/concurrency/runthread.html">threads</a>, namely a Red and Green producer and a Blue consumer.
These threads communicate with each other via a shared buffer that is protected by a <a class="reference external" href="https://en.wikipedia.org/wiki/Semaphore_(programming)">semaphore</a>.
If a thread wants to operate on the buffer, it tries acquire a token from the semaphore that protects the buffer.
Once acquired, the process can write to the buffer without being disturbed by any other process.
Finally, the process releases the token, which allows other processes to operate on the buffer.</p>
<p>The same stategy is used to alternate the writes to the buffer. Each producer has its own semaphore.
If a producer wants to write to a buffer, it first tries to acquire a token from its semaphore.
After writing to the buffer, the producer hands over the token to the other producer.</p>
</div>
<div class="section" id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h2>
<p>Let us now analyze the Java implementation by answering a few simple questions.</p>
<ol class="arabic simple">
<li>Where is the &#8220;Hello, &#8221; string computed?</li>
</ol>
<p>On line 15: <cite>String redText = &#8220;Hello, &#8221;;</cite>.</p>
<ol class="arabic simple" start="2">
<li>Where is the text printed?</li>
</ol>
<p>On line 53: <cite>System.out.print(buffer);</cite>.</p>
<p>For the next question, however, it is not possible to point at a single line of code:</p>
<ol class="arabic" start="3">
<li><p class="first">Where is the protocol?</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>What determines which producers goes first?</li>
</ol>
<p>This is determined by the initial value of the semaphores on lines 5 and 6, together with the acquire and release statements of the semaphores on lines 17, 21, 33, and 37.</p>
<ol class="loweralpha simple" start="2">
<li>What takes care of buffer protection?</li>
</ol>
<p>This is established by the acquire and release statements of the buffer semaphore on lines 18, 20, 34, 36, 51, and 57.</p>
</div></blockquote>
</li>
</ol>
<p>The reason why this third question is much more difficult to answer is because the protocol is <strong>implicit</strong>.</p>
<p>For such a simple program, you may argue that the fact that the protocol is implicit is not big deal.
However, if you really think this, then you may be surprised by the output:</p>
<div class="highlight-text"><div class="highlight"><pre>Hello, world! Hello, Hello, world! Hello, Hello, Hello, Hello, Hello,
</pre></div>
</div>
<p>There is a bug! Can you spot the error?</p>
</div>
<div class="section" id="reo-protocols">
<h2>Reo protocols<a class="headerlink" href="#reo-protocols" title="Permalink to this headline">¶</a></h2>
<p>The Reo language offers a solution by providing a domain specific language that allow you to declare your protocol explicitly.
The following diagram shows an example of such an explicit protocol:</p>
<img alt="https://github.com/kasperdokter/Reo/blob/master/docs/ProdCons.jpg?raw=true" src="https://github.com/kasperdokter/Reo/blob/master/docs/ProdCons.jpg?raw=true" />
<p>Every process is represented as a box together with a set of ports that define the interface of each process.
These boxes, called components, are connected via a network of channels and nodes, which constitutes the protocol.
The components now interact with each other by offering messages to the protocol.
The protocol, then, synchonizes components and exchanges the messages.</p>
<p>The channel between Red and Green is a <em>syncdrain</em> channel that accepts data from both its input ends simultaneously, and then it looses the data.
The channel between Red and Blue is a <em>sync</em> channel that atomically takes data from its input end and offers this data to its output end.
The other incoming channel connected to Blue is a <em>fifo1</em> channel that stores a single data item that it receives at its input end.
After the buffer became full, it offers this data to its output end.
Suppose Red wants to output some data. Then, Red issues a <em>put request</em> at its port.
As soon as Green has also issued a <em>put request</em>, and Blue issued a <em>get request</em>, the protocol synchronously accepts the data produced by Red and Green, offers Greens data to Blue, and stores Reds data in a buffer.
Upon the next get request by Blue, Blue receives the data from the buffer, after which the protocol returned to its initial configuration.
Therefore, this protocol implements the informal specification that prescribes alternation.</p>
<p>Although we may think of such a protocol as <a class="reference external" href="http://mpi-forum.org/">message passing</a>, the code that is generated by the compiler
is (depending on the target) based on shared memory.</p>
</div>
<div class="section" id="compilation">
<h2>Compilation<a class="headerlink" href="#compilation" title="Permalink to this headline">¶</a></h2>
<p>The first step consist of isolating the computation that is done in each process.
To this end, we create a Java class in <tt class="docutils literal"><span class="pre">Processes.java</span></tt> that contains the a method for each original process:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">nl.cwi.reo.runtime.Input</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">nl.cwi.reo.runtime.Output</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Processes</span> <span class="o">{</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">Red</span><span class="o">(</span><span class="n">Output</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">port</span><span class="o">)</span> <span class="o">{</span>
   <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">30000000</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">);</span>
      <span class="n">String</span> <span class="n">datum</span> <span class="o">=</span> <span class="s">&quot;Hello, &quot;</span><span class="o">;</span>
      <span class="n">port</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">datum</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">Green</span><span class="o">(</span><span class="n">Output</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">port</span><span class="o">)</span> <span class="o">{</span>
   <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50000000</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">);</span>
      <span class="n">String</span> <span class="n">datum</span> <span class="o">=</span> <span class="s">&quot;world! &quot;</span><span class="o">;</span>
      <span class="n">port</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">datum</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">Blue</span><span class="o">(</span><span class="n">Input</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">port</span><span class="o">)</span> <span class="o">{</span>
   <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="o">++</span><span class="n">k</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">40000000</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">);</span>
         <span class="n">String</span> <span class="n">datum</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">datum</span><span class="o">);</span>
      <span class="o">}</span>
   <span class="o">}</span>
   <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Note that the code of each Java method is completely independent of any other method, since no variables are explicitly shared.
Synchronization and data transfer is delegated to put and get calls to output ports and input ports, respectively.
This way, we strictly separate computation from interaction, defined by the protocol.</p>
<p>In the next step, we declare the protocol by means of the Reo file called <tt class="docutils literal"><span class="pre">main.treo</span></tt>:</p>
<div class="highlight-text"><div class="highlight"><pre>import reo.syncdrain;
import reo.sync;
import reo.fifo1;

// The main component
main(a,b,c) { green(a) red(b) blue(c) alternator(a,b,c) }

// The atomic components
red(a!String) { Java: &quot;Processes.Red&quot; }
green(a!String) { Java: &quot;Processes.Green&quot; }
blue(a?String) { Java: &quot;Processes.Blue&quot; }

// The alternator protocol
alternator(a,b,c) { syncdrain(a, b) sync(b, x) fifo1(x, c) sync(a, c) }
</pre></div>
</div>
<p>This Reo file defines the main component, which is a set containing an instance of the Red, Green, and Blue process, and an instance of the alternator protocol.
The definition Red, Green, and Blue processes just refers to the Java source code from <tt class="docutils literal"><span class="pre">Processes.java</span></tt>.
The definition of the alternator protocol is expressed using primitive Reo channels, which are imported from the standard library.</p>
<p>Before we can compile this Reo file into Java code, please first follow the instructions in <a class="reference internal" href="installation.html#installation"><em>Installation</em></a> to install the Reo compiler.
Next, change directory to where <tt class="docutils literal"><span class="pre">main.treo</span></tt> and <tt class="docutils literal"><span class="pre">Processes.java</span></tt> are located, and execute:</p>
<div class="highlight-python"><div class="highlight"><pre>reo main.treo
javac Main.java
java Main
</pre></div>
</div>
<p>These commands respectively</p>
<blockquote>
<div><ol class="arabic simple">
<li>compile Reo code to Java source code (by generating <tt class="docutils literal"><span class="pre">main.java</span></tt>),</li>
<li>compile Java source code to executable Java classes, and</li>
<li>execute the complete program.</li>
</ol>
</div></blockquote>
<p>Since the alternator protocol defined in <tt class="docutils literal"><span class="pre">main.treo</span></tt> matches the informal specification, and since the generated code correctly implements the alternator procotol, the output now looks as follows:</p>
<div class="highlight-text"><div class="highlight"><pre>Hello, world! Hello, world! Hello, world! Hello, world! Hello, world!
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial.html" class="btn btn-neutral float-right" title="Tutorial" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="Installation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2017, Kasper Dokter.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>